<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ST12R1J3V0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'G-ST12R1J3V0');
    </script>
    <title>EXCEL - not an expert</title>
</head>

<nav class="my-5 mx-5 fixed-top rounded-pill border-4 p-2 navbar navbar-expand-md bg-body-tertiary navbar-light bg-white" style="opacity:0.75;"> 
    <div class="container-fluid">
      <a class="navbar-brand badge text-wrap bg-primary text-white rounded-pill border border-4 p-1 m-2" style="width: 6rem;" href="../index.html">EXCEL - not an expert</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <form class="d-flex" role="search" action="https://google.com/search" target="_blank" method="get">
          
        <input class="rounded-pill border" style="height: 50px;width: 50px" type="image" src="../Img/Excel -not an expert.jpg" alt="Search" class="img-fluid">
    </form>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active badge text-wrap bg-danger text-white rounded-pill border border-4 p-1 m-2" style="width: 6rem;" aria-current="page" href="../index.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link badge text-wrap bg-danger text-white rounded-pill border border-4 p-1 m-3" style="width: 6rem;" href="contact.html">Contact</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle badge text-wrap bg-danger text-white rounded-pill border border-4 p-1" style="width: 6rem;" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              THEMES
            </a>
            <ul class="dropdown-menu" style="max-height: 450px;overflow-x: hidden; overflow-y: auto;">
              <li><a class="dropdown-item" href="1.html">1. Sort unique filtered values</a></li>
              <li><a class="dropdown-item" href="2.html">2. Concatenate</a></li>
              <li><a class="dropdown-item" href="3.html">3. Data validation using “Name Manager”</a></li>
              <li><a class="dropdown-item" href="4.html">4. Countifs</a></li>
              <li><a class="dropdown-item" href="5.html">5. Averageif and Averageifs</a></li>
              <li><a class="dropdown-item" href="6.html">6. Unique values on a filtered table</a></li>
              <li><a class="dropdown-item" href="7.html">7. Total of values on a filtered table</a></li>
              <li><a class="dropdown-item" href="8.html">8. Controlling Repeated values using “Name manager”</a></li>
              <li><a class="dropdown-item" href="9.html">9. Controlling values not included in a another table</a></li>
              <li><a class="dropdown-item" href="10.html">10. Slicer</a></li>
              <li><a class="dropdown-item" href="11.html">11. Unique values per month on a filtered table</a></li>
              <li><a class="dropdown-item" href="12.html">12. Total of values per month on a filtered table</a></li>
              <li><a class="dropdown-item" href="13.html">13. Swiping down all filled values</a></li>
              <li><a class="dropdown-item" href="14.html">14. PictureLookup</a></li>
              <li><a class="dropdown-item" href="15.html">15. Unique values filtered by date</a></li>
              <li><a class="dropdown-item" href="16.html">16. Sequence by rows</a></li>
              <li><a class="dropdown-item" href="17.html">17. Randarray and Textjoin</a></li>
              <li><a class="dropdown-item" href="18.html">18. Timestamp non volatile</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" href="Others.html">Others</a></li>
             </ul>
          </li>
          
        </ul>

                       
        <form class="d-flex" role="search" action="https://google.com/search" target="_blank" method="get">
        
          <input class="rounded-pill border" style="height: 50px;width: 50px" type="image" src="../Img/gg.jpg" alt="Search" class="img-fluid">
      </form>
        
        <form class="d-flex align-items-center" role="search" action="https://google.com/search" target="_blank" method="get">
            <input class="form-control me-2 m-3 p-3 rounded-pill border border-5" id="keyword" type="search" name="q" placeholder="Search" aria-label="Search">
           
            <input class="rounded-pill border" onclick="searchSite();" style="height: 50px;width: 50px" type="image" src="../Img/button.jpg" alt="Search" class="img-fluid">
        </form>
       

        </div>
      </div>
    
  </nav>
<body>
   
    <nav aria-label="Page navigation example navbar navbar-expand-md">
        <div class="container-fluid" style="padding-top: 150px;">
        <ul class="my-4 mx-4 pagination pagination-sm justify-content-center">
          
            <pre><div class="row">
                <table class="mx-1 table text-center table-hover">
                    
            <tbody>
                <tr>
                    <td><li class="page-item"><a class="page-link rounded-pill" href="1.html">1</a></li></td>
                        <td><li class="page-item"><a class="page-link rounded-pill" href="2.html">2</a></li></td>
                        <td><li class="page-item"><a class="page-link rounded-pill" href="3.html">3</a></li></td>
                        <td><li class="page-item"><a class="page-link rounded-pill" href="4.html">4</a></li></td>
                        <td><li class="page-item"><a class="page-link rounded-pill" href="5.html">5</a></li></td>
                        <td><li class="page-item"><a class="page-link rounded-pill" href="6.html">6</a></li></td>
                        <td><li class="page-item"><a class="page-link rounded-pill" href="7.html">7</a></li></td>
                        <td><li class="page-item"><a class="page-link rounded-pill" href="8.html">8</a></li></td>
                        <td><li class="page-item"><a class="page-link rounded-pill" href="9.html">9</a></li></td></tr>
                        <tr><td><li class="page-item"><a class="page-link rounded-pill" href="10.html">10</a></li></td>
                            <td><li class="page-item"><a class="page-link rounded-pill" href="11.html">11</a></li></td>
                                <td><li class="page-item"><a class="page-link rounded-pill" href="12.html">12</a></li></td>
                                    <td><li class="page-item"><a class="page-link rounded-pill" href="13.html">13</a></li></td>
                                        <td><li class="page-item"><a class="page-link rounded-pill" href="14.html">14</a></li></td>
                                            <td><li class="page-item"><a class="page-link rounded-pill" href="15.html">15</a></li></td>
                                                <td><li class="page-item"><a class="page-link rounded-pill" href="16.html">16</a></li></td>
                                                    <td><li class="page-item"><a class="page-link rounded-pill" href="17.html">17</a></li></td>
                                                        <td><li class="page-item"><a class="page-link rounded-pill" href="18.html">18</a></li></td></tr></td>
          </tbody>
        </table>
    
    </div></pre>
 
        </ul></div>
      </nav>
            
    <div class="row my-5"></div>

       <section id="12" class="bg-light mt-5 mb-5">
        <div class="container-lg">
            <div class="text-center">
                <h2>12. Total of values per month on a filtered table</h2>
                <br>
                <br>
                <p>&emsp;PROBLEM:

                    &emsp;How to count values per month in a filtered table?</p>
<br>
<code>
                <p class="lead text-muted" style="line-height: 220%;text-align:left;background-color:rgb(255, 248, 240);">=IFERROR(IF(SUM(

                    IF(FREQUENCY(IF(SUBTOTAL(103;OFFSET($Q$22;ROW($Q$22:$Q$27)-ROW($Q$22);;1))*(MONTH($R$22:$R$27)=MONTH(O4))*($R$22:$R$27<>"");
                    
                    IF($Q$22:$Q$27<>"";
                    
                    MATCH("~"&$Q$22:$Q$27;$Q$22:$Q$27&"";0)));
                    
                    ROW($Q$22:$Q$27)-ROW($Q$22)+1);1))=0;"";<span style="color:red">SUM(
                    
                    IF(FREQUENCY(IF(SUBTOTAL(103;OFFSET($Q$22;ROW($Q$22:$Q$27)-ROW($Q$22);;1))*(MONTH($R$22:$R$27)=MONTH(O4))*($R$22:$R$27<>"");
                    
                    IF($Q$22:$Q$27<>"";
                    
                    MATCH("~"&$Q$22:$Q$27;$Q$22:$Q$27&"";0)));
                    
                    ROW($Q$22:$Q$27)-ROW($Q$22)+1);1)))</span>;"")</p>
                </code>
<br>
                <br>
                <div style="font-size: 14px;text-align:left;">                         
                    <ol>
                        <P>This formula is a nested IFERROR, SUMPRODUCT, and SUBTOTAL function that returns the sum of the number of cells in the range Q22:Q27 where the value in the column DATE is in the same month as the current month and the value in the cell is not empty.                                            
                            <br>
                            <br>
                            If there are no such cells, it returns an empty string.
                            <br>
                            <br>
                            Here’s how it works:
                            <br>
                            <br>
                            <li>&emsp;ROW($Q$22:$Q$27)-ROW($Q$22)+1 returns an array of numbers from 1 to 6.</li>
                                <br><li>&emsp;OFFSET($Q$22;ROW($Q$22:$Q$27)-ROW($Q$22);;1) returns an array of cells in the range $Q$22:$Q$27.</li>
                                <br><li>&emsp;SUBTOTAL(103;...) returns an array of subtotal values for each cell in the array returned by step 2.</li>
                                <br><li>&emsp;(MONTH($R$22:$R$27)=MONTH(O9)) returns an array of TRUE or FALSE values where each value is TRUE if the month in the corresponding cell in the column DATE of the table SOURCE is equal to the current month.</li>
                               <br><li>&emsp;($R$22:$R$27<>"") returns an array of TRUE or FALSE values where each value is TRUE if the corresponding cell in the column R of the table SOURCE is not empty.</li>
                               <br><li>&emsp;IF(...) returns an array of values where each value is either a match number or an empty string.</li>
                               <br><li>&emsp;FREQUENCY(IF(...);1) returns an array of frequency counts for each unique value in the array returned by step 6.</li>
                               <br><li>&emsp;SUM(...) returns the sum of the array returned by step 7, which is the number of cells in the range Q22:Q27 where the value in the column DATE is in the same month as the current month and the value in the cell is not empty.</li>
                               <br><li>&emsp;The tilde symbol (~) in Excel is used as an escape character. It tells Excel to treat the next character in the formula as a literal character, rather than as a special character.
                                <br><br>For example, if you want to use an asterisk (*) in a formula, but you don’t want Excel to interpret it as a multiplication operator, you can precede it with a tilde symbol.
                                <br><br> So, instead of typing =A1*B1, you would type =A1~*B1.
                                The tilde symbol is also used to escape other special characters in Excel formulas, such as the question mark (?), the left bracket ([), and the right bracket (]).


                                <br><br>In the formula provided, the tilde symbol (~) is used as an escape character to treat the next character in the formula as a literal character, rather than as a special character. In this case, the tilde symbol is used to escape the ampersand (&) character, which is a special character in Excel formulas.
                                
                                
                                <br><br>The formula provided is checking if the cells in the range Q22:Q27 are not empty. If a cell is not empty, it returns the result of the MATCH function.
                                <br><br> The MATCH function searches for the value of the cell in the range Q22:Q27 and returns the position of the first cell that matches the search value. The tilde symbol is used to escape the ampersand character in the formula.
                                                                            
                                                                                                                         
                                                                                       
                                </li>
                            </P></ol>
                                                           
                </div>

            </div>

        

        </div> 
    
        <br><br>


<div class="col-9 col-lg-4 mx-auto">

  <iframe class="position-absolute start-50 translate-middle-x pb-5" col-4 width="360" height="250" src="https://www.youtube.com/embed/z7X2zQhI-r8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>

        
<!--<video class="position-absolute start-50 translate-middle-x" col-4 width="320" height="240" controls src="..\video\Total12.mp4" autoplay>
    Your browser does not support the video format!
</video>-->

</div>
    </section>
    
    <script>
      function searchSite() {
      var x = document.getElementById("keyword").value;
      const url_s="https://www.google.com/search?q=intext:";
      const url_e="+site%3Aexcel-notanexpert.com&aqs=chrome..69i57.12675j0j1&sourceid=chrome&ie=UTF-8"
      var url = url_s + x + url_e;
      var win=window.open(url, '_self');
      win.focus();
      
      }
      
      </script>


    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
</body>

</html>